{% extends 'base.html' %}
{% load static %}
{% block content %}
	<div class="col-md-8">
		<h1 class="my-3">{% block content_header %}Главная страница. Вопросы{% endblock %}</h1>
		<form name="orderForm">
			<label class="my-3" for="sortQuestions">Сортировать по:</label>
			<select id="sortQuestions" name="order" type="submit">
				{% if request.GET.order == 'pub_date' %}
					<option value="pub_date" selected>дате</option>
				{% else %}
					<option value="pub_date">дате</option>
				{% endif %}
				{% if request.GET.order == 'rating' %}
					<option value="rating" selected>рейтингу</option>
				{% else %}
					<option value="rating">рейтингу</option>
				{% endif %}
				{% if request.GET.order == 'title' %}
					<option value="title" selected>заголовку</option>
				{% else %}
					<option value="title">заголовку</option>
				{% endif %}
			</select>
		</form>
		{% for question in questions %}
			<div class="card mb-4">
				<div class="card-body">
					<a href="{% url 'forum:question' question.id %}"><h2 class="card-title">{{ question.get_title_short }}</h2></a>
					<p class="card-text mb-1">{{ question.get_text_short }}</p>
					<p class="mt-0 mb-2 text-secondary">
						{% for question_tag in question.tags.all %}
							#{{ question_tag }}&nbsp;
						{% endfor %}
					</p>
					<a class="btn btn-primary" href="{% url 'forum:question' question.id %}">Перейти &rarr;</a>
					<i style="float: right">Ответов: <b>{{ question.answers_count }}</b>&nbsp;&nbsp;&nbsp;Рейтинг:
						{% if question.rating > 0 %}
							<b class="text-success">+{{ question.rating }}</b>
						{% elif question.rating < 0 %}
							<b class="text-danger">{{ question.rating }}</b>
						{% else %}
							<b>0</b>
						{% endif %}
					</i>
				</div>
				<div class="card-footer text-muted">Задан {{ question.pub_date }} пользователем <a href="{% url 'forum:user' question.author.id %}">{{ question.author }}</a></div>
			</div>
		{% endfor %}
		<ul class="pagination justify-content-center mb-4">
			{% if questions.has_previous %}
				<li class="page-item">
					{% if request.GET.order %}
						<a class="page-link" href="?order={{ request.GET.order }}&page={{ questions.previous_page_number }}">&larr; Предыдущие</a>
					{% else %}
						<a class="page-link" href="?page={{ questions.previous_page_number }}">&larr; Предыдущие</a>
					{% endif %}
				</li>
			{% else %}
				<li class="page-item disabled">
					<a class="page-link">&larr; Предыдущие</a>
				</li>
			{% endif %}
			{% if questions.has_next %}
				<li class="page-item">
					{% if request.GET.order %}
						<a class="page-link" href="?order={{ request.GET.order }}&page={{ questions.next_page_number }}">Следующие &rarr;</a>
					{% else %}
						<a class="page-link" href="?page={{ questions.next_page_number }}">Следующие &rarr;</a>
					{% endif %}
				</li>
			{% else %}
				<li class="page-item disabled">
					<a class="page-link">Следующие &rarr;</a>
				</li>
			{% endif %}
		</ul>
	</div>
{% endblock %}
{% block script %}
	<script src="{% static 'questions.js' %}" type="text/javascript"></script>
{% endblock %}